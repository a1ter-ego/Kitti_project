# KITTI数据的点云成像
## 1. 数据集介绍
[kitti数据集](https://www.cvlibs.net/datasets/kitti/ "kitti数据集官网")主要包含了4个主要文件：标定校准文件(calib),图像文件(image_2),标签文件(lable_2),雷达数据集文件(velodyne)。
<br/><br/>
### 1.1 标定校准文件(calib)
- 内参矩阵：P0-P3分别表示4个相机的内参矩阵，或投影矩阵, 大小为 3x4。相机内参矩阵是为了计算点云空间位置坐标在相机坐标系下的坐标，即把点云坐标投影到相机坐标系。将相机的内参矩阵乘以点云在世界坐标系中的坐标即可得到点云在相机坐标系中的坐标。
- 外参矩阵：存在三种坐标系世界坐标系、相机坐标系、激光雷达坐标系。世界坐标系反映了物体的真实位置坐标，也是作为相机坐标系和激光雷达坐标系之间相互变换的过渡坐标系。
- R0校准矩阵：R0_rect 为0号相机的修正矩阵，大小为3x3，目的是为了使4个相机成像达到共面的效果，保证4个相机光心在同一个xoy平面上。在进行外参矩阵变化之后，需要于R0_rect相乘得到相机坐标系下的坐标。
<br/><br/>
### 1.2 图像文件
相机拍摄的彩色图
<br/><br/>
### 1.3 标签文件(lable_2)
记录了路面车辆种类和行人的信息
<br/><br/>
### 1.4 雷达数据集文件(velodyne)
雷达所采集数据集，都是bin文件，方便软件工具读取。有多少张照片，对应就有多少个bin文件。bin里面都是每个像素的实际坐标值(x,y,z,r)。由于雷达坐标系的x轴是向前的，所以其x值反映了深度。
   

## 2. 点云坐标到相机坐标的转化
点云坐标在相机坐标系中的坐标等于内参矩阵 * 外参矩阵 * R0校准矩阵 * 点云坐标，即：
<br/><br/>
P * R0_rect *Tr_velo_to_cam * x

例如，要将Velodyne激光雷达坐标系中的点x投影到左侧的彩色图像中y，使用公式：<br>
y = P2 * R0_rect *Tr_velo_to_cam * x

当计算出y < 0的时候表明该点在相机的后面。

## 3. 效果图片展示：

二维成像：
![2D效果图](https://github.com/Bizarrer/images/blob/main/images/2D.png?raw=true "二维点云图")

三维成像：
![3D效果图](https://github.com/Bizarrer/images/blob/main/images/3D.png?raw=true "三维点云图")
